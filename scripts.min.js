function rootUrl(n){return""+n}function webApiUrl(n){return"/"+n}function errorhandler(n,t){console.error(n,t)}function rootPartialsUrl(n){return document.location.href.indexOf("localhost")>=0?rootUrl("partials/")+n:rootUrl(n)}function rootDirectivesUrl(n){return document.location.href.indexOf("localhost")>=0?rootUrl("js/directives/")+n:rootUrl(n)}function rootJsUrl(n){return document.location.href.indexOf("localhost")>=0?rootUrl("js/")+n:rootUrl(n)}var babaOmoApp=angular.module("BabaOmoApp",["ui.router"]),sampleFatherLoci,sampleChildLoci,doc;babaOmoApp.config(function(n,t,i){i.html5Mode(!0);t.otherwise("/info");n.state("home",{url:"/",templateUrl:rootPartialsUrl("splash.html")}).state("info",{url:"/info",templateUrl:rootPartialsUrl("info.html"),controller:"InfoCtrl"}).state("child",{url:"/child",templateUrl:rootPartialsUrl("child.html"),controller:"AllelesCtrl"}).state("father",{url:"/father",templateUrl:rootPartialsUrl("father.html"),controller:"AllelesCtrl"}).state("result",{url:"/result",templateUrl:rootPartialsUrl("result.html"),controller:"ResultCtrl"})});babaOmoApp.factory("babaOmoFactory",function(n){var t={};return t.init=function(i){return i.getCountries=function(){return n.get(rootJsUrl("countries.json")).error(errorhandler)},i.getAlleles=function(){return n.get(rootJsUrl("alleles.json")).error(errorhandler)},i.String=String,i.Math=Math,i.Array=Array,i.Number=Number,t},t});babaOmoApp.controller("AllelesCtrl",function(n,t,i){var r,u;n.babaOmoFactory=i.init(n);r=function(i){this.name=i||"";this.alleles=[];var r=this;this.init=function(){for(var n=0;n<8;n++)this.addAllelePair();return this};this.generateChildAllelePairs=function(){if(!n.babaOmoFactory.fatherInfo){t.go("father");return}return n.babaOmoFactory.fatherInfo.alleles.slice(0).forEach(function(n){n.allele1=0;n.allele2=0;r.alleles.push(n)}),this};this.generateFatherAllelePairs=function(){if(!n.babaOmoFactory.info){t.go("info");return}return this.addAllelePair(),this};this.addAllelePair=function(){return(this.alleles.length==0||this.alleles.reduce(function(n,t){return n&&t.validate()},!0))&&this.alleles.push(new u),this};this.removeAllelePair=function(t){return t=Number(t)||0,this.alleles.length>t&&t>=0&&(n.selectedAlleleNames.splice(n.selectedAlleleNames.indexOf(this.alleles[t].name),1),this.alleles.splice(t,1)),this};this.validate=function(){return this.alleles.reduce(function(n,t){return n&&t.validate()},!0)}};n.AlleleInfo=r;n.AlleleInfo.create=function(n){return new r(n)};u=function(){this.name="Allele";this.allele1=0;this.allele2=0;this.validate=function(){var t,i;return doc.remError("[data-allele-pair-valid] input,select"),this.valid=!0,t=n.alleleInfo.alleles.map(function(n){return n.name}),t.distinct().length<t.length?(i=t.filter(function(n){return t.count(function(t){return t==n})>1}).distinct(),setTimeout(function(){i.forEach(function(n){doc.setError("select[data-allele-pair-name='"+n+"']","duplicate allele names")})},300),this.valid=!1):!String.isNullOrEmpty(this.name)&&this.name!="Allele"&&this.allele1>0&&this.allele2>0?this.valid=!0:(String.isNullOrEmpty(this.name)||this.name=="Allele"?doc.setError("[data-allele-pair-valid='false'] [ng-model='allelePair.name']","choose a valid allele name"):this.allele1?this.allele2||doc.setError("[data-allele-pair-valid='false'] [ng-model='allelePair.allele2']","choose a value for allele2"):doc.setError("[data-allele-pair-valid='false'] [ng-model='allelePair.allele1']","choose a value for allele1"),this.valid=!1),this.valid}};n.selectedAlleleNames=[];n.getAlleles().then(function(t){console.log("alleles",t.data);t.data.splice(0,0,"Allele");n.alleleNames=t.data;n.babaOmoFactory.alleleNames=t.data});n.proceedToChild=function(){n.alleleInfo.validate()&&(n.babaOmoFactory[n.alleleInfo.name+"Info"]=n.alleleInfo,t.go("child"))};n.proceedToResult=function(){n.alleleInfo.validate()&&(n.babaOmoFactory[n.alleleInfo.name+"Info"]=n.alleleInfo,t.go("result"))}});babaOmoApp.controller("InfoCtrl",function(n,t,i){n.babaOmoFactory=i.init(n);n.countries=[];n.getCountries().then(function(t){console.log("countries",t.data);n.countries=t.data;n.countries=n.countries.sort(function(n,t){return n.name>t.name});n.countries.splice(0,0,{name:"Choose a Country"})});var r=function(){this.name="";this.email="";this.country="";this.gender="male";this.dob="01/01/2002";var i=this;this.validate=function(){doc.remError("#inputName,#inputEmail,#inputCountry,#inputGender");String.isNullOrEmpty(i.name)?doc.setError("#inputName","Invalid Name"):String.isNullOrEmpty(i.email)||!/(\w+(\d*)(\w*))+\@(\w+(\d*)(\w*))+\.(\w+(\d*)(\w*))+/.test(i.email)?doc.setError("#inputEmail","Invalid Email Address"):String.isNullOrEmpty(i.country)?doc.setError("#inputCountry","Invalid Country"):String.isNullOrEmpty(i.gender)?doc.setError("#inputGender","Invalid Gender"):(i.submit(),n.babaOmoFactory.info=i)};this.submit=function(){n.babaOmoFactory.info=i;t.go("father")}};n.info=new r});sampleFatherLoci=[{name:"D3S1358",allele1:15,allele2:16},{name:"D7S820",allele1:11,allele2:11},{name:"VWA",allele1:13,allele2:16},{name:"FGA",allele1:22,allele2:28},{name:"D8S1179",allele1:13,allele2:14},{name:"D21S11",allele1:28,allele2:32.2},{name:"D18S51",allele1:17,allele2:18},{name:"D5S818",allele1:8,allele2:12}];sampleChildLoci=[{name:"D3S1358",allele1:16,allele2:17},{name:"D7S820",allele1:8,allele2:11},{name:"VWA",allele1:14,allele2:16},{name:"FGA",allele1:21,allele2:28},{name:"D8S1179",allele1:14,allele2:15},{name:"D21S11",allele1:28,allele2:32.2},{name:"D18S51",allele1:17,allele2:18},{name:"D5S818",allele1:8,allele2:14}];babaOmoApp.controller("ResultCtrl",function(n,t,i,r){n.babaOmoFactory=r.init(n);var u={priorProbabilities:[.1,.2,.3,.4,.5,.6,.7,.8,.9],childLoci:(n.babaOmoFactory.childInfo||{}).alleles||sampleChildLoci,fatherLoci:(n.babaOmoFactory.fatherInfo||{}).alleles||sampleFatherLoci,populationCode:(n.babaOmoFactory.info||{}).country||"NIG"};n.getVerdicts=function(){return console.log("request",u),i.post(webApiUrl("api/paternity/getVerdicts"),u).success(function(t){n.verdicts=(t||{}).Result;console.log("get-verdict",t)}).error(function(n,t){console.error(n,t)})}});Array.prototype.without=function(n){var t=this;return t.filter(function(t){return n.indexOf(t)<0})};babaOmoApp.directive("allelePair",function(){return{restrict:"AE",templateUrl:rootDirectivesUrl("allele-pair.dir.html"),scope:{allelePair:"=",alleleNames:"=",selectedAlleleNames:"=",index:"@",removeAllelePair:"&removeAllelePair",changeAlleleName:"@"},link:function(){},controller:function(n,t){n.babaOmoFactory=t.init(n);n.chooseAlleleName=function(){n.allelePair.validate()};n.getChangeAlleleName=function(){return n.changeAlleleName=String.isNullOrEmpty(n.changeAlleleName)?"false":n.changeAlleleName,n.changeAlleleName=n.changeAlleleName.toString().toLowerCase()=="false"?!1:!0,n.changeAlleleName}}}});$(".form-control").on("focus blur",function(n){$(this).parents(".form-group").toggleClass("focused",n.type==="focus"||this.value.length>0)}).trigger("blur");$(document).ready(function(){});String.isNullOrEmpty=function(n){return n==null||n==""};doc={setError:function(n,t){$(n).each(function(){$(this).css("border","1px solid red");$(this).notify(t,"error")})},remError:function(n){$(n).each(function(){$(this).css("border","");$(this).trigger("notify-hide")})}};Array.prototype.paginate=function(n){var t=this;return n=n||1,t.reduce(function(t,i){return t[t.length-1]&&t[t.length-1].length!=n||t.push([]),t[t.length-1].push(i),t},[])};Array.prototype.flatten=function(){var n=this;return n.reduce(function(n,t){return n.concat(t)},[])};Array.prototype.distinct=function(n){n=n||function(n){return n};var t=this;return t.reduce(function(t,i){return t.indexOf(n(i))<0?t.concat(i):t},[])};Array.prototype.find||(Array.prototype.find=function(n){var i,t;for(n=n||function(n){return n},i=this,t=0;t<i.length;t++)if(n(i[t]))return i[t];return null});Array.prototype.findIndex||(Array.prototype.findIndex=function(n){var i,t;for(n=n||function(n){return n},i=this,t=0;t<i.length;t++)if(n(i[t]))return t;return-1});Array.prototype.count=function(n){var t=this;return n=n||function(n){return n},t.filter(n).length};